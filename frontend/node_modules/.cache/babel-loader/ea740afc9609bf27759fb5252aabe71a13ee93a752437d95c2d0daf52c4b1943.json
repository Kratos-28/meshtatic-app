{"ast":null,"code":"var _jsxFileName = \"/Users/surajarya/Documents/meshtastic-app/frontend/src/App.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { MapContainer, TileLayer, Marker, Popup, Polyline, useMap } from \"react-leaflet\";\nimport L from \"leaflet\";\nimport \"leaflet/dist/leaflet.css\";\n\n// =============================\n// CUSTOM PHONE ICONS\n// =============================\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst icons = {\n  NODE_A: L.icon({\n    iconUrl: \"/icon/node1.png\",\n    iconSize: [40, 40],\n    iconAnchor: [20, 40],\n    popupAnchor: [0, -35]\n  }),\n  NODE_B: L.icon({\n    iconUrl: \"/icon/node2.png\",\n    iconSize: [40, 40],\n    iconAnchor: [20, 40],\n    popupAnchor: [0, -35]\n  })\n};\n\n// =============================\n// AUTO-FIT MAP ON NODE CHANGE\n// =============================\nfunction AutoFitMap({\n  nodes\n}) {\n  _s();\n  const map = useMap();\n  useEffect(() => {\n    const positions = Object.values(nodes).map(n => [n.lat, n.lon]);\n    if (positions.length > 0) {\n      map.fitBounds(positions, {\n        padding: [50, 50]\n      });\n    }\n  }, [nodes, map]);\n  return null;\n}\n_s(AutoFitMap, \"IoceErwr5KVGS9kN4RQ1bOkYMAg=\", false, function () {\n  return [useMap];\n});\n_c = AutoFitMap;\nfunction App() {\n  _s2();\n  const [nodes, setNodes] = useState({});\n  useEffect(() => {\n    const ws = new WebSocket(\"ws://localhost:8000/ws\");\n    ws.onmessage = event => {\n      const data = JSON.parse(event.data);\n\n      // build trail history\n      setNodes(prev => {\n        var _prev$data$node_id;\n        const history = ((_prev$data$node_id = prev[data.node_id]) === null || _prev$data$node_id === void 0 ? void 0 : _prev$data$node_id.history) || [];\n        const updatedHistory = [...history, [data.lat, data.lon]].slice(-50);\n        return {\n          ...prev,\n          [data.node_id]: {\n            ...data,\n            history: updatedHistory\n          }\n        };\n      });\n    };\n    return () => ws.close();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(MapContainer, {\n    center: [12.97, 77.59],\n    zoom: 13,\n    style: {\n      height: \"100vh\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n      url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(AutoFitMap, {\n      nodes: nodes\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this), Object.entries(nodes).map(([id, node]) => /*#__PURE__*/_jsxDEV(React.Fragment, {\n      children: [node.history && /*#__PURE__*/_jsxDEV(Polyline, {\n        positions: node.history,\n        pathOptions: {\n          color: id === \"NODE_A\" ? \"blue\" : \"red\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(Marker, {\n        position: [node.lat, node.lon],\n        icon: icons[id] || icons.NODE_A,\n        children: /*#__PURE__*/_jsxDEV(Popup, {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: id\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 36\n          }, this), \"Lat: \", node.lat.toFixed(5), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 41\n          }, this), \"Lon: \", node.lon.toFixed(5)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 11\n      }, this)]\n    }, id, true, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 9\n    }, this))]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 5\n  }, this);\n}\n_s2(App, \"k/4l6mUPxMEz4V3kxdsuHTxp/VY=\");\n_c2 = App;\nexport default App;\nvar _c, _c2;\n$RefreshReg$(_c, \"AutoFitMap\");\n$RefreshReg$(_c2, \"App\");","map":{"version":3,"names":["React","useEffect","useState","MapContainer","TileLayer","Marker","Popup","Polyline","useMap","L","jsxDEV","_jsxDEV","icons","NODE_A","icon","iconUrl","iconSize","iconAnchor","popupAnchor","NODE_B","AutoFitMap","nodes","_s","map","positions","Object","values","n","lat","lon","length","fitBounds","padding","_c","App","_s2","setNodes","ws","WebSocket","onmessage","event","data","JSON","parse","prev","_prev$data$node_id","history","node_id","updatedHistory","slice","close","center","zoom","style","height","children","url","fileName","_jsxFileName","lineNumber","columnNumber","entries","id","node","Fragment","pathOptions","color","position","toFixed","_c2","$RefreshReg$"],"sources":["/Users/surajarya/Documents/meshtastic-app/frontend/src/App.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { \n  MapContainer, \n  TileLayer, \n  Marker, \n  Popup, \n  Polyline, \n  useMap \n} from \"react-leaflet\";\nimport L from \"leaflet\";\nimport \"leaflet/dist/leaflet.css\";\n\n// =============================\n// CUSTOM PHONE ICONS\n// =============================\nconst icons = {\n  NODE_A: L.icon({\n    iconUrl: \"/icon/node1.png\",\n    iconSize: [40, 40],\n    iconAnchor: [20, 40],\n    popupAnchor: [0, -35]\n  }),\n  NODE_B: L.icon({\n    iconUrl: \"/icon/node2.png\",\n    iconSize: [40, 40],\n    iconAnchor: [20, 40],\n    popupAnchor: [0, -35]\n  })\n};\n\n// =============================\n// AUTO-FIT MAP ON NODE CHANGE\n// =============================\nfunction AutoFitMap({ nodes }) {\n  const map = useMap();\n\n  useEffect(() => {\n    const positions = Object.values(nodes).map(n => [n.lat, n.lon]);\n    if (positions.length > 0) {\n      map.fitBounds(positions, { padding: [50, 50] });\n    }\n  }, [nodes, map]);\n\n  return null;\n}\n\nfunction App() {\n  const [nodes, setNodes] = useState({});\n\n  useEffect(() => {\n    const ws = new WebSocket(\"ws://localhost:8000/ws\");\n\n    ws.onmessage = (event) => {\n      const data = JSON.parse(event.data);\n\n      // build trail history\n      setNodes(prev => {\n        const history = prev[data.node_id]?.history || [];\n        const updatedHistory = [...history, [data.lat, data.lon]].slice(-50);\n\n        return {\n          ...prev,\n          [data.node_id]: {\n            ...data,\n            history: updatedHistory\n          }\n        };\n      });\n    };\n\n    return () => ws.close();\n  }, []);\n\n  return (\n    <MapContainer \n      center={[12.97, 77.59]} \n      zoom={13} \n      style={{ height: \"100vh\" }}\n    >\n      <TileLayer url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\" />\n\n      <AutoFitMap nodes={nodes} />\n\n      {Object.entries(nodes).map(([id, node]) => (\n        <React.Fragment key={id}>\n\n          {/* TRAIL */}\n          {node.history && (\n            <Polyline\n              positions={node.history}\n              pathOptions={{ color: id === \"NODE_A\" ? \"blue\" : \"red\" }}\n            />\n          )}\n\n          {/* MARKER */}\n          <Marker\n            position={[node.lat, node.lon]}\n            icon={icons[id] || icons.NODE_A}\n          >\n            <Popup>\n              <strong>{id}</strong><br />\n              Lat: {node.lat.toFixed(5)}<br />\n              Lon: {node.lon.toFixed(5)}\n            </Popup>\n          </Marker>\n\n        </React.Fragment>\n      ))}\n    </MapContainer>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}